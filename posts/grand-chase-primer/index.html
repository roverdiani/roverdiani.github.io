<!doctype html><html lang=en-US><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet type=text/css href=/css/font.css><link rel=stylesheet type=text/css href=/css/style.css><link rel=stylesheet type=text/css href=/css/theme_toggler.css><title>Roverdi's Website | Grand Chase Primer</title>
<script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js></script><script>MathJax={tex:{displayMath:[["\\[","\\]"],["$$","$$"]],inlineMath:[["$","$"]]},loader:{load:["ui/safe"]}}</script></head><body><div class=container><div class=header><div class=header-utils><div class=js-theme-toggler-wrapper><div class=js-theme-toggler><div class=js-theme-toggler-track><div class=js-theme-toggler-track-check><img src="data:image/png;base64,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" role=presentation style=pointer-events:none width=16 height=16></div><div class=js-theme-toggler-track-x><img src="data:image/png;base64,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" role=presentation style=pointer-events:none width=16 height=16></div></div><div class=js-theme-toggler-thumb></div><input class=js-theme-toggler-screenreader-only type=checkbox aria-label="Toggle between Dark and Light mode"></div></div><script>(()=>{const t=document.body,e=document.querySelector(".js-theme-toggler");if(!e)return;e.addEventListener("click",()=>{const n=t.classList.toggle("dark-mode");e.classList.toggle("js-theme-toggler--checked",n),e.classList.add("js-theme-toggler--focus"),n?localStorage.setItem("darkMode","true"):localStorage.removeItem("darkMode")}),localStorage.getItem("darkMode")&&(e.classList.add("js-theme-toggler--checked"),t.classList.add("dark-mode"))})()</script></div><div class=header-container><div class=site-title><a class="menu-link h3 title" href=/>RODRIGO VERDIANI</a></div><hr class=divider><div class=menu><ul><li class="flex-item h6"><a class="menu-link title" href=/>HOME</a></li><li class="flex-item h6"><a class="menu-link title" href=/about>ABOUT</a></li><li class="flex-item h6"><a class="menu-link title" href=/contact>CONTACT</a></li><li class="flex-item h6"><a class="menu-link title" href=/posts/index.xml>RSS</a></li></ul></div></div></div><div class=line-break></div><div id=content><article class=article-body><div class=article-title><div class=back-link-div style=float:left;text-align:left><script>document.write('<a class="back-link" href="'+document.referrer+'">Go Back</a>')</script></div><br><br><div class="h6 title">22/06/2025</div><div><div class="h5 title" style=float:left>Grand Chase Primer</div></div></div><br><hr class=divider><div class=article-content><blockquote><p><em><strong>Note:</strong></em> this article is still a work in progress - stay tuned for more updates.</p></blockquote><h1 id=introduction>Introduction</h1><p>Grand Chase is a 2D side-scrolling online game developed by the South Korean studio KOG. It was launched in Brazil in 2005 by Level Up! Games, the same publisher that also distributed Gravity&rsquo;s Ragnarok Online (another time sink of mine), as well as GunZ: The Duel (around 2006) and Perfect World (late 2000s).</p><p>All of these games were hugely popular in Brazil during my early teens, and I probably spent more time than I should&rsquo;ve playing them instead of doing homework or other boring stuff.</p><p>Grand Chase, however, holds a special place in my heart. I have fond memories of the time I spent playing it with friends, and I&rsquo;ve also always had a soft spot for side-scrolling games.</p><figure><img src=/img/gc/gc.png><figcaption><h4>Grande Chase's first mission</h4></figcaption></figure><p>That being said, another hobby of mine was trying to hack the game whenever I could - oops. But that is a story for another time.</p><p>Games in general, and specially online ones, have always captivated me and made me curious about how they work. I&rsquo;ve put a lot of time and effort into trying to understand their inner workings (I even ran a World of Warcraft private server at one point), and with Grand Chase, it wasn&rsquo;t any different.</p><p>So, on this page, I&rsquo;ll be writing about the things I&rsquo;ve learned by digging into the available material on the game. Hope you find it interesting!</p><hr><h1 id=table-of-contents>Table of Contents</h1><nav id=TableOfContents><ul><li><a href=#networking>Networking</a><ul><li><a href=#packet-size>Packet Size</a></li><li><a href=#security-layer>Security Layer</a></li><li><a href=#payload-layer>Payload Layer</a></li></ul></li></ul></nav><hr><h2 id=networking>Networking</h2><p>In this section, we&rsquo;ll talk about how the game&rsquo;s networking works - the packet structure, security protocols, compression, and so on.</p><p>Below, you can see the overall structure of the game&rsquo;s packets:</p><pre class=mermaid>
  packet-beta
title Overall Packet Structure
0-3: &#34;Packet Size&#34;
4-7: &#34;SP Index&#34;
8-15: &#34;Sequence Number&#34;
16-23: &#34;Initialization Vector&#34;
24-55: &#34;Payload Data (variable length)&#34;
56-63: &#34;Integrity Check Value&#34;
</pre><p>To help us understand how everything works together, we&rsquo;ll separate this structure into three parts: the packet size, the security layer, and the payload layer.</p><blockquote><p>Note: aside from the decrypted payload data&rsquo;s content, all the fields here are <a href=https://en.wikipedia.org/wiki/Endianness>little-endian</a>.</p></blockquote><h3 id=packet-size>Packet Size</h3><p>As the name implies, this field tells us the total size (in bytes) of the received packet - simple as that. Here&rsquo;s an example:</p><pre tabindex=0><code class=language-hex data-lang=hex>4A 00
</code></pre><p>That value means that we have exactly <strong>74 bytes</strong> in our packet.</p><h3 id=security-layer>Security Layer</h3><p>This layer is built upon a variation of the security protocol called <a href=https://en.wikipedia.org/wiki/IPsec#Encapsulating_Security_Payload>Encapsulating Security Payload</a>, from the <a href=https://en.wikipedia.org/wiki/IPsec>IPsec</a> suite, and consists of the Security Parameters Index, Sequence Number, Initialization Vector, and Integrity Check Value fields.</p><p>This protocol provides authentication, data integrity, and confidentiality to the data being transmitted, in addition to protection against <a href=https://en.wikipedia.org/wiki/Replay_attack>replay attacks</a> (more on that later).</p><h4 id=security-association>Security Association</h4><p>TODO</p><h4 id=security-parameters-index-sp-index-or-spi>Security Parameters Index (SP Index, or SPI)</h4><p>These two bytes represent an arbitrary value used (together with the destination IP address) to identify the security association that should be used by the packet receiver (client or server).</p><blockquote><p>Note: both the client and the server use different security associations, so an SP Index is defined for each of them. Because of this, the packets sent by either party will contain different SP Indexes in their security layers.</p></blockquote><p>For a new connection, this value will always refer to the default security association, since no key exchange has taken place yet. Examples:</p><pre tabindex=0><code class=language-Hex data-lang=Hex>// Default SP Index
00 00

// Arbitrary value
13 4F

// Maximum value
FF FF
</code></pre><blockquote><p>Curiosity: in the original server code, there was a bug where, if there were no more slots available for a new SP Index, the code would hang in an infinite loop. However, this was an edge case - you&rsquo;d need 65,534 players connected to fill up all the slots, which would probably never happen in the practice.</p></blockquote><h4 id=sequence-number>Sequence Number</h4><p>This is a counter that increments by 1 for every packet sent and is used to protect against replay attacks. Each security association should have its own separate counter.</p><p>Used together with a <a href=https://en.wikipedia.org/wiki/Mask_(computing)>mask</a>, an algorithm performs a check to see wether the packet has already been received or not.</p><p>The sequence number cannot be zero, as it would be considered invalid and would cause the communication to be closed. Example:</p><pre tabindex=0><code class=language-hex data-lang=hex>// Valid sequence number
03 00 00 00
</code></pre><h4 id=initialization-vector-iv>Initialization Vector (IV)</h4><p>TODO</p><h4 id=integrity-check-value-icv>Integrity Check Value (ICV)</h4><p>TODO</p><h3 id=payload-layer>Payload Layer</h3></div></article></div><div class=line-break></div><div class=footer><hr class=divider><div class=social><ul><li class=flex-item><a href=https://www.instagram.com/roverdiani/ target=_blank rel=noopener title=Instagram><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="2" width="20" height="20" rx="5" ry="5"/><path d="M16 11.37A4 4 0 1112.63 8 4 4 0 0116 11.37z"/><line x1="17.5" y1="6.5" x2="17.5" y2="6.5"/></svg></a></li><li class=flex-item><a href=https://www.linkedin.com/in/rodrigo-verdiani/ target=_blank rel=noopener title=Linkedin><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg></a></li><li class=flex-item><a href=https://github.com/roverdiani target=_blank rel=noopener title=Github><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></li></ul></div></div></div><script type=module>
                import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs';
                mermaid.initialize({ startOnLoad: true });
            </script></body></html>